var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends"));var _objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));var _createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass"));var _possibleConstructorReturn2=_interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));var _getPrototypeOf3=_interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));var _inherits2=_interopRequireDefault(require("@babel/runtime/helpers/inherits"));var _react=_interopRequireWildcard(require("react"));var _isEqual=_interopRequireDefault(require("lodash/isEqual"));var _popup=_interopRequireDefault(require("../popup"));var _pickerView=_interopRequireDefault(require("../picker-view"));var _parseProps=_interopRequireDefault(require("../picker-view/utils/parseProps"));var _removeFnFromProps=_interopRequireDefault(require("../picker-view/utils/removeFnFromProps"));var _jsxFileName="/Users/linji/Documents/workspace/zarm/zarm/components/picker/Picker.tsx";var Picker=function(_Component){(0,_inherits2.default)(Picker,_Component);function Picker(){var _getPrototypeOf2;var _this;(0,_classCallCheck2.default)(this,Picker);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=(0,_possibleConstructorReturn2.default)(this,(_getPrototypeOf2=(0,_getPrototypeOf3.default)(Picker)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.isScrolling=false;_this.state=_parseProps.default.getSource(_this.props);_this.onChange=function(selected){var _this$props=_this.props,valueMember=_this$props.valueMember,onChange=_this$props.onChange;var value=selected.map(function(item){return item[valueMember];});_this.setState({value:value,objValue:selected});if(typeof onChange==='function'){onChange(selected);}};_this.onCancel=function(){var onCancel=_this.props.onCancel;var _this$state=_this.state,_this$state$tempValue=_this$state.tempValue,tempValue=_this$state$tempValue===void 0?[]:_this$state$tempValue,_this$state$tempObjVa=_this$state.tempObjValue,tempObjValue=_this$state$tempObjVa===void 0?[]:_this$state$tempObjVa;_this.setState({value:tempValue,objValue:tempObjValue});if(typeof onCancel==='function'){onCancel();}};_this.onOk=function(){if(_this.isScrolling){return false;}var _this$state2=_this.state,value=_this$state2.value,_this$state2$objValue=_this$state2.objValue,objValue=_this$state2$objValue===void 0?[]:_this$state2$objValue;_this.setState({value:value,objValue:objValue});var onOk=_this.props.onOk;if(typeof onOk==='function'){onOk(objValue);}};_this.onTransition=function(isScrolling){var onTransition=_this.props.onTransition;_this.isScrolling=isScrolling;if(typeof onTransition==='function'){onTransition(isScrolling);}};return _this;}(0,_createClass2.default)(Picker,[{key:"render",value:function render(){var _this2=this;var _this$props2=this.props,prefixCls=_this$props2.prefixCls,className=_this$props2.className,cancelText=_this$props2.cancelText,okText=_this$props2.okText,title=_this$props2.title,locale=_this$props2.locale,maskClosable=_this$props2.maskClosable,mountContainer=_this$props2.mountContainer,destroy=_this$props2.destroy,onOk=_this$props2.onOk,onCancel=_this$props2.onCancel,visible=_this$props2.visible,others=(0,_objectWithoutProperties2.default)(_this$props2,["prefixCls","className","cancelText","okText","title","locale","maskClosable","mountContainer","destroy","onOk","onCancel","visible"]);var value=this.state.value;var noop=function noop(){};return _react.default.createElement(_popup.default,{className:className,visible:visible,onMaskClick:maskClosable?this.onCancel:noop,mountContainer:mountContainer,destroy:destroy,__self:this,__source:{fileName:_jsxFileName,lineNumber:106}},_react.default.createElement("div",{className:prefixCls,onClick:function onClick(e){e.stopPropagation();},__self:this,__source:{fileName:_jsxFileName,lineNumber:113}},_react.default.createElement("div",{className:prefixCls+"__header",__self:this,__source:{fileName:_jsxFileName,lineNumber:114}},_react.default.createElement("div",{className:prefixCls+"__cancel",onClick:this.onCancel,__self:this,__source:{fileName:_jsxFileName,lineNumber:115}},cancelText||locale.cancelText),_react.default.createElement("div",{className:prefixCls+"__title",__self:this,__source:{fileName:_jsxFileName,lineNumber:116}},title||locale.title),_react.default.createElement("div",{className:prefixCls+"__submit",onClick:this.onOk,__self:this,__source:{fileName:_jsxFileName,lineNumber:117}},okText||locale.okText)),_react.default.createElement(_pickerView.default,(0,_extends2.default)({},others,{value:value,onChange:this.onChange,onTransition:function onTransition(isScrolling){_this2.onTransition(isScrolling);},__self:this,__source:{fileName:_jsxFileName,lineNumber:119}}))));}}],[{key:"getDerivedStateFromProps",value:function getDerivedStateFromProps(props,state){if(!(0,_isEqual.default)((0,_removeFnFromProps.default)(props,['onOk','onCancel','onChange']),(0,_removeFnFromProps.default)(state.prevProps,['onOk','onCancel','onChange']))){return(0,_extends2.default)({prevProps:props},_parseProps.default.getSource(props),{tempValue:_parseProps.default.getSource(props).value,tempObjValue:_parseProps.default.getSource(props).objValue});}return null;}}]);return Picker;}(_react.Component);exports.default=Picker;Picker.defaultProps={dataSource:[],prefixCls:'za-picker',valueMember:'value',cols:Infinity,maskClosable:true,itemRender:function itemRender(data){return data.label;},destroy:false};